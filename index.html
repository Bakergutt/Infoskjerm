<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Infoskjerm</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #f0f0f0;
    }

    .slide {
      display: none;
      padding: 2rem;
      height: 100vh;
      box-sizing: border-box;
    }

    .active {
      display: block;
    }

    h2 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .data {
      font-size: 1.5rem;
      line-height: 2rem;
    }

    #vaergraf img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>

  <!-- Slide 1: Værmelding -->
  <div class="slide active" id="weather">
    <h2>☁️ Værmelding (live)</h2>
    <div class="data" id="weather-data">Laster værdata...</div>
  </div>

  <!-- Slide 2: Havvarsel -->
  <div class="slide" id="ocean">
    <h2>🌊 Havvarsel (live)</h2>
    <div class="data" id="ocean-data">Laster havdata...</div>
  </div>

  <!-- Slide 3: Værgraf -->
  <div class="slide" id="vaergraf">
    <h2>📊 Værgraf</h2>
    <img id="grafbilde" src="" alt="Værgraf fra YR">
  </div>

  <!-- Slide 4: Trygghetsinfo -->
  <div class="slide" id="info">
    <h2>🛟 Trygghetsutstyr</h2>
    <ul>
      <li>Livbøye: Ved brygga</li>
      <li>Hjertestarter: Klubblokalet, 1. etasje</li>
      <li>Nødnummer: 113</li>
    </ul>
  </div>

  <script>
    // Slide-rotasjon (hver 15. sekund)
    const slides = document.querySelectorAll('.slide');
    let current = 0;

    setInterval(() => {
      slides[current].classList.remove('active');
      current = (current + 1) % slides.length;
      slides[current].classList.add('active');
    }, 15000);

    // 1: Hent værdata
    function hentVaerdata() {
      fetch('https://api.met.no/weatherapi/locationforecast/2.0/compact?lat=60.528789&lon=4.815853', {
        headers: {
          'User-Agent': 'Infoskjerm/1.0 toftketil@gmail.com'
        }
      })
      .then(response => response.json())
      .then(data => {
        const forecast = data.properties.timeseries[0].data.instant.details;
        const temp = forecast.air_temperature;
        const wind = forecast.wind_speed;

        document.getElementById('weather-data').innerHTML = `
          🌡️ Temperatur: ${temp} °C<br>
          💨 Vind: ${wind} m/s
        `;
      })
      .catch(err => {
        console.error('Feil ved værdata:', err);
      });
    }

    hentVaerdata();
    setInterval(hentVaerdata, 600000); // hvert 10. minutt

    // 2: Hent havdata
    function hentHavdata() {
      fetch('https://api.met.no/weatherapi/oceanforecast/2.0/complete.json?lat=60.528789&lon=4.815853', {
        headers: {
          'User-Agent': 'Infoskjerm/1.0 toftketil@gmail.com'
        }
      })
      .then(response => response.json())
      .then(data => {
        const sea = data.properties.timeseries[0].sea;
        const wave = sea.significant_wave_height;
        const temp = sea.sea_water_temperature;
        const current = sea.sea_water_speed;

        document.getElementById('ocean-data').innerHTML = `
          🌊 Bølgehøyde: ${wave} m<br>
          🌡️ Vanntemp: ${temp} °C<br>
          💨 Strøm: ${current} m/s
        `;
      })
      .catch(err => {
        console.error('Feil ved havdata:', err);
      });
    }

    hentHavdata();
    setInterval(hentHavdata, 600000); // hvert 10. minutt

    // 3: Oppdater værgraf-bilde automatisk
    function oppdaterGraf() {
      const ts = new Date().getTime();
      const url = `vaergraf.png?ts=${ts}`;
      document.getElementById('grafbilde').src = url;
    }

    oppdaterGraf();
    setInterval(oppdaterGraf, 3600000); // hver time
  </script>

</body>
</html>
